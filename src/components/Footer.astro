---
import { execSync } from 'child_process';

// Get git info at build time
let gitHash = '4dc5ecc';
let gitDate = '2026-01-29';
try {
	gitHash = execSync('git rev-parse --short HEAD', { encoding: 'utf-8' }).trim();
	gitDate = execSync('git log -1 --format=%cd --date=short', { encoding: 'utf-8' }).trim();
} catch (e) {
	// Fallback if git not available
}
---

<footer>
	<div class="footer-content">
		<img src="/floodboy-logo.png" alt="Floodboy Logo" />
		<span class="brand">FloodBoy: IoT-Powered Blockchain</span>
		<span class="separator">|</span>
		<span class="tagline">Real-time flood monitoring for smart cities</span>
	</div>
	<div class="footer-info">
		<span class="rpc-info">RPC: <a href="/rpc" id="active-rpc"><code>checking...</code></a></span>
		<span class="separator">•</span>
		<span class="git-info">Git: <code>{gitHash}</code> ({gitDate})</span>
		<span class="separator">•</span>
		<span class="contract-info">Factory (JIBCHAIN): <a href="https://exp.jibchain.net/address/0x63bB41b79b5aAc6e98C7b35Dcb0fE941b85Ba5Bb" target="_blank" rel="noopener noreferrer"><code>0x63bB...5Bb</code></a></span>
	</div>
	<script>
		// Show active RPC in footer
		const rpcEl = document.getElementById('active-rpc');
		if (rpcEl) {
			const preferred = localStorage.getItem('floodboy_preferred_rpc');
			const defaultRpc = 'https://rpc-l1.inan.in.th';
			const activeRpc = preferred || defaultRpc;
			const hostname = new URL(activeRpc).hostname;
			rpcEl.innerHTML = `<code>${hostname}</code>`;
			rpcEl.title = activeRpc;
		}
	</script>
</footer>
<style>
	footer {
		padding: 2rem 0;
		background-color: #f9fafb;
		margin-top: auto;
	}
	
	.footer-content {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 0.5rem;
		color: #4b5563;
	}
	
	.footer-content img {
		height: 2rem;
		width: auto;
	}
	
	.brand {
		font-weight: 600;
	}
	
	.separator {
		color: #d1d5db;
	}
	
	.tagline {
		font-size: 0.875rem;
	}
	
	.footer-info {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 0.5rem;
		margin-top: 0.5rem;
		font-size: 0.75rem;
		color: #6b7280;
	}
	
	.footer-info code {
		background-color: #e5e7eb;
		padding: 0.125rem 0.25rem;
		border-radius: 0.25rem;
		font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
		font-size: 0.7rem;
	}
	
	.footer-info a {
		color: #3b82f6;
		text-decoration: none;
	}
	
	.footer-info a:hover {
		text-decoration: underline;
	}

	@media (max-width: 640px) {
		.tagline {
			display: none;
		}
		.separator {
			display: none;
		}
		.footer-info {
			flex-direction: column;
			gap: 0.25rem;
		}
		.footer-info .separator {
			display: none;
		}
	}
</style>
